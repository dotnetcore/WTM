{"remainingRequest":"C:\\Users\\liuli\\source\\repos\\github\\WalkingTec.Mvvm\\WebApplication2\\ClientApp\\node_modules\\babel-loader\\lib\\index.js??ref--4-oneOf-1-1!C:\\Users\\liuli\\source\\repos\\github\\WalkingTec.Mvvm\\WebApplication2\\ClientApp\\node_modules\\rc-menu\\es\\SubPopupMenu.js","dependencies":[{"path":"C:\\Users\\liuli\\source\\repos\\github\\WalkingTec.Mvvm\\WebApplication2\\ClientApp\\node_modules\\rc-menu\\es\\SubPopupMenu.js","mtime":1546413208000},{"path":"C:\\Users\\liuli\\source\\repos\\github\\WalkingTec.Mvvm\\WebApplication2\\ClientApp\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\liuli\\source\\repos\\github\\WalkingTec.Mvvm\\WebApplication2\\ClientApp\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import _objectWithoutProperties from 'babel-runtime/helpers/objectWithoutProperties';\nimport _classCallCheck from 'babel-runtime/helpers/classCallCheck';\nimport _possibleConstructorReturn from 'babel-runtime/helpers/possibleConstructorReturn';\nimport _inherits from 'babel-runtime/helpers/inherits';\nimport _extends from 'babel-runtime/helpers/extends';\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { connect } from 'mini-store';\nimport KeyCode from 'rc-util/es/KeyCode';\nimport createChainedFunction from 'rc-util/es/createChainedFunction';\nimport classNames from 'classnames';\nimport { getKeyFromChildrenIndex, loopMenuItem, noop, menuAllProps, isMobileDevice } from './util';\nimport DOMWrap from './DOMWrap';\n\nfunction allDisabled(arr) {\n  if (!arr.length) {\n    return true;\n  }\n\n  return arr.every(function (c) {\n    return !!c.props.disabled;\n  });\n}\n\nfunction updateActiveKey(store, menuId, activeKey) {\n  var _extends2;\n\n  var state = store.getState();\n  store.setState({\n    activeKey: _extends({}, state.activeKey, (_extends2 = {}, _extends2[menuId] = activeKey, _extends2))\n  });\n}\n\nfunction getEventKey(props) {\n  // when eventKey not available ,it's menu and return menu id '0-menu-'\n  return props.eventKey || '0-menu-';\n}\n\nexport function getActiveKey(props, originalActiveKey) {\n  var activeKey = originalActiveKey;\n  var children = props.children,\n      eventKey = props.eventKey;\n\n  if (activeKey) {\n    var found = void 0;\n    loopMenuItem(children, function (c, i) {\n      if (c && !c.props.disabled && activeKey === getKeyFromChildrenIndex(c, eventKey, i)) {\n        found = true;\n      }\n    });\n\n    if (found) {\n      return activeKey;\n    }\n  }\n\n  activeKey = null;\n\n  if (props.defaultActiveFirst) {\n    loopMenuItem(children, function (c, i) {\n      if (!activeKey && c && !c.props.disabled) {\n        activeKey = getKeyFromChildrenIndex(c, eventKey, i);\n      }\n    });\n    return activeKey;\n  }\n\n  return activeKey;\n}\nexport function saveRef(c) {\n  if (c) {\n    var index = this.instanceArray.indexOf(c);\n\n    if (index !== -1) {\n      // update component if it's already inside instanceArray\n      this.instanceArray[index] = c;\n    } else {\n      // add component if it's not in instanceArray yet;\n      this.instanceArray.push(c);\n    }\n  }\n}\nexport var SubPopupMenu = function (_React$Component) {\n  _inherits(SubPopupMenu, _React$Component);\n\n  function SubPopupMenu(props) {\n    var _extends3;\n\n    _classCallCheck(this, SubPopupMenu);\n\n    var _this = _possibleConstructorReturn(this, _React$Component.call(this, props));\n\n    _initialiseProps.call(_this);\n\n    props.store.setState({\n      activeKey: _extends({}, props.store.getState().activeKey, (_extends3 = {}, _extends3[props.eventKey] = getActiveKey(props, props.activeKey), _extends3))\n    });\n    _this.instanceArray = [];\n    return _this;\n  }\n\n  SubPopupMenu.prototype.componentDidMount = function componentDidMount() {\n    // invoke customized ref to expose component to mixin\n    if (this.props.manualRef) {\n      this.props.manualRef(this);\n    }\n  };\n\n  SubPopupMenu.prototype.shouldComponentUpdate = function shouldComponentUpdate(nextProps) {\n    return this.props.visible || nextProps.visible;\n  };\n\n  SubPopupMenu.prototype.componentDidUpdate = function componentDidUpdate(prevProps) {\n    var props = this.props;\n    var originalActiveKey = 'activeKey' in props ? props.activeKey : props.store.getState().activeKey[getEventKey(props)];\n    var activeKey = getActiveKey(props, originalActiveKey);\n\n    if (activeKey !== originalActiveKey) {\n      updateActiveKey(props.store, getEventKey(props), activeKey);\n    } else if ('activeKey' in prevProps) {\n      // If prev activeKey is not same as current activeKey,\n      // we should set it.\n      var prevActiveKey = getActiveKey(prevProps, prevProps.activeKey);\n\n      if (activeKey !== prevActiveKey) {\n        updateActiveKey(props.store, getEventKey(props), activeKey);\n      }\n    }\n  }; // all keyboard events callbacks run from here at first\n\n\n  SubPopupMenu.prototype.render = function render() {\n    var _this2 = this;\n\n    var props = _objectWithoutProperties(this.props, []);\n\n    this.instanceArray = [];\n    var className = classNames(props.prefixCls, props.className, props.prefixCls + '-' + props.mode);\n    var domProps = {\n      className: className,\n      // role could be 'select' and by default set to menu\n      role: props.role || 'menu'\n    };\n\n    if (props.id) {\n      domProps.id = props.id;\n    }\n\n    if (props.focusable) {\n      domProps.tabIndex = '0';\n      domProps.onKeyDown = this.onKeyDown;\n    }\n\n    var prefixCls = props.prefixCls,\n        eventKey = props.eventKey,\n        visible = props.visible,\n        level = props.level,\n        mode = props.mode,\n        overflowedIndicator = props.overflowedIndicator,\n        theme = props.theme;\n    menuAllProps.forEach(function (key) {\n      return delete props[key];\n    }); // Otherwise, the propagated click event will trigger another onClick\n\n    delete props.onClick;\n    return (// ESLint is not smart enough to know that the type of `children` was checked.\n\n      /* eslint-disable */\n      React.createElement(DOMWrap, _extends({}, props, {\n        prefixCls: prefixCls,\n        mode: mode,\n        tag: 'ul',\n        level: level,\n        theme: theme,\n        hiddenClassName: prefixCls + '-hidden',\n        visible: visible,\n        overflowedIndicator: overflowedIndicator\n      }, domProps), React.Children.map(props.children, function (c, i) {\n        return _this2.renderMenuItem(c, i, eventKey || '0-menu-');\n      }))\n      /*eslint-enable */\n\n    );\n  };\n\n  return SubPopupMenu;\n}(React.Component);\nSubPopupMenu.propTypes = {\n  onSelect: PropTypes.func,\n  onClick: PropTypes.func,\n  onDeselect: PropTypes.func,\n  onOpenChange: PropTypes.func,\n  onDestroy: PropTypes.func,\n  openTransitionName: PropTypes.string,\n  openAnimation: PropTypes.oneOfType([PropTypes.string, PropTypes.object]),\n  openKeys: PropTypes.arrayOf(PropTypes.string),\n  visible: PropTypes.bool,\n  children: PropTypes.any,\n  parentMenu: PropTypes.object,\n  eventKey: PropTypes.string,\n  store: PropTypes.shape({\n    getState: PropTypes.func,\n    setState: PropTypes.func\n  }),\n  // adding in refactor\n  focusable: PropTypes.bool,\n  multiple: PropTypes.bool,\n  style: PropTypes.object,\n  defaultActiveFirst: PropTypes.bool,\n  activeKey: PropTypes.string,\n  selectedKeys: PropTypes.arrayOf(PropTypes.string),\n  defaultSelectedKeys: PropTypes.arrayOf(PropTypes.string),\n  defaultOpenKeys: PropTypes.arrayOf(PropTypes.string),\n  level: PropTypes.number,\n  mode: PropTypes.oneOf(['horizontal', 'vertical', 'vertical-left', 'vertical-right', 'inline']),\n  triggerSubMenuAction: PropTypes.oneOf(['click', 'hover']),\n  inlineIndent: PropTypes.oneOfType([PropTypes.number, PropTypes.string]),\n  manualRef: PropTypes.func,\n  itemIcon: PropTypes.oneOfType([PropTypes.func, PropTypes.node]),\n  expandIcon: PropTypes.oneOfType([PropTypes.func, PropTypes.node])\n};\nSubPopupMenu.defaultProps = {\n  prefixCls: 'rc-menu',\n  className: '',\n  mode: 'vertical',\n  level: 1,\n  inlineIndent: 24,\n  visible: true,\n  focusable: true,\n  style: {},\n  manualRef: noop\n};\n\nvar _initialiseProps = function _initialiseProps() {\n  var _this3 = this;\n\n  this.onKeyDown = function (e, callback) {\n    var keyCode = e.keyCode;\n    var handled = void 0;\n\n    _this3.getFlatInstanceArray().forEach(function (obj) {\n      if (obj && obj.props.active && obj.onKeyDown) {\n        handled = obj.onKeyDown(e);\n      }\n    });\n\n    if (handled) {\n      return 1;\n    }\n\n    var activeItem = null;\n\n    if (keyCode === KeyCode.UP || keyCode === KeyCode.DOWN) {\n      activeItem = _this3.step(keyCode === KeyCode.UP ? -1 : 1);\n    }\n\n    if (activeItem) {\n      e.preventDefault();\n      updateActiveKey(_this3.props.store, getEventKey(_this3.props), activeItem.props.eventKey);\n\n      if (typeof callback === 'function') {\n        callback(activeItem);\n      }\n\n      return 1;\n    }\n  };\n\n  this.onItemHover = function (e) {\n    var key = e.key,\n        hover = e.hover;\n    updateActiveKey(_this3.props.store, getEventKey(_this3.props), hover ? key : null);\n  };\n\n  this.onDeselect = function (selectInfo) {\n    _this3.props.onDeselect(selectInfo);\n  };\n\n  this.onSelect = function (selectInfo) {\n    _this3.props.onSelect(selectInfo);\n  };\n\n  this.onClick = function (e) {\n    _this3.props.onClick(e);\n  };\n\n  this.onOpenChange = function (e) {\n    _this3.props.onOpenChange(e);\n  };\n\n  this.onDestroy = function (key) {\n    /* istanbul ignore next */\n    _this3.props.onDestroy(key);\n  };\n\n  this.getFlatInstanceArray = function () {\n    return _this3.instanceArray;\n  };\n\n  this.getOpenTransitionName = function () {\n    return _this3.props.openTransitionName;\n  };\n\n  this.step = function (direction) {\n    var children = _this3.getFlatInstanceArray();\n\n    var activeKey = _this3.props.store.getState().activeKey[getEventKey(_this3.props)];\n\n    var len = children.length;\n\n    if (!len) {\n      return null;\n    }\n\n    if (direction < 0) {\n      children = children.concat().reverse();\n    } // find current activeIndex\n\n\n    var activeIndex = -1;\n    children.every(function (c, ci) {\n      if (c && c.props.eventKey === activeKey) {\n        activeIndex = ci;\n        return false;\n      }\n\n      return true;\n    });\n\n    if (!_this3.props.defaultActiveFirst && activeIndex !== -1 && allDisabled(children.slice(activeIndex, len - 1))) {\n      return undefined;\n    }\n\n    var start = (activeIndex + 1) % len;\n    var i = start;\n\n    do {\n      var child = children[i];\n\n      if (!child || child.props.disabled) {\n        i = (i + 1) % len;\n      } else {\n        return child;\n      }\n    } while (i !== start);\n\n    return null;\n  };\n\n  this.renderCommonMenuItem = function (child, i, extraProps) {\n    var state = _this3.props.store.getState();\n\n    var props = _this3.props;\n    var key = getKeyFromChildrenIndex(child, props.eventKey, i);\n    var childProps = child.props;\n    var isActive = key === state.activeKey;\n\n    var newChildProps = _extends({\n      mode: childProps.mode || props.mode,\n      level: props.level,\n      inlineIndent: props.inlineIndent,\n      renderMenuItem: _this3.renderMenuItem,\n      rootPrefixCls: props.prefixCls,\n      index: i,\n      parentMenu: props.parentMenu,\n      // customized ref function, need to be invoked manually in child's componentDidMount\n      manualRef: childProps.disabled ? undefined : createChainedFunction(child.ref, saveRef.bind(_this3)),\n      eventKey: key,\n      active: !childProps.disabled && isActive,\n      multiple: props.multiple,\n      onClick: function onClick(e) {\n        (childProps.onClick || noop)(e);\n\n        _this3.onClick(e);\n      },\n      onItemHover: _this3.onItemHover,\n      openTransitionName: _this3.getOpenTransitionName(),\n      openAnimation: props.openAnimation,\n      subMenuOpenDelay: props.subMenuOpenDelay,\n      subMenuCloseDelay: props.subMenuCloseDelay,\n      forceSubMenuRender: props.forceSubMenuRender,\n      onOpenChange: _this3.onOpenChange,\n      onDeselect: _this3.onDeselect,\n      onSelect: _this3.onSelect,\n      builtinPlacements: props.builtinPlacements,\n      itemIcon: childProps.itemIcon || _this3.props.itemIcon,\n      expandIcon: childProps.expandIcon || _this3.props.expandIcon\n    }, extraProps); // ref: https://github.com/ant-design/ant-design/issues/13943\n\n\n    if (props.mode === 'inline' || isMobileDevice()) {\n      newChildProps.triggerSubMenuAction = 'click';\n    }\n\n    return React.cloneElement(child, newChildProps);\n  };\n\n  this.renderMenuItem = function (c, i, subMenuKey) {\n    /* istanbul ignore if */\n    if (!c) {\n      return null;\n    }\n\n    var state = _this3.props.store.getState();\n\n    var extraProps = {\n      openKeys: state.openKeys,\n      selectedKeys: state.selectedKeys,\n      triggerSubMenuAction: _this3.props.triggerSubMenuAction,\n      subMenuKey: subMenuKey\n    };\n    return _this3.renderCommonMenuItem(c, i, extraProps);\n  };\n};\n\nvar connected = connect()(SubPopupMenu);\nexport default connected;",{"version":3,"sources":["C:\\Users\\liuli\\source\\repos\\github\\WalkingTec.Mvvm\\WebApplication2\\ClientApp\\node_modules\\rc-menu\\es\\SubPopupMenu.js"],"names":["_objectWithoutProperties","_classCallCheck","_possibleConstructorReturn","_inherits","_extends","React","PropTypes","connect","KeyCode","createChainedFunction","classNames","getKeyFromChildrenIndex","loopMenuItem","noop","menuAllProps","isMobileDevice","DOMWrap","allDisabled","arr","length","every","c","props","disabled","updateActiveKey","store","menuId","activeKey","_extends2","state","getState","setState","getEventKey","eventKey","getActiveKey","originalActiveKey","children","found","i","defaultActiveFirst","saveRef","index","instanceArray","indexOf","push","SubPopupMenu","_React$Component","_extends3","_this","call","_initialiseProps","prototype","componentDidMount","manualRef","shouldComponentUpdate","nextProps","visible","componentDidUpdate","prevProps","prevActiveKey","render","_this2","className","prefixCls","mode","domProps","role","id","focusable","tabIndex","onKeyDown","level","overflowedIndicator","theme","forEach","key","onClick","createElement","tag","hiddenClassName","Children","map","renderMenuItem","Component","propTypes","onSelect","func","onDeselect","onOpenChange","onDestroy","openTransitionName","string","openAnimation","oneOfType","object","openKeys","arrayOf","bool","any","parentMenu","shape","multiple","style","selectedKeys","defaultSelectedKeys","defaultOpenKeys","number","oneOf","triggerSubMenuAction","inlineIndent","itemIcon","node","expandIcon","defaultProps","_this3","e","callback","keyCode","handled","getFlatInstanceArray","obj","active","activeItem","UP","DOWN","step","preventDefault","onItemHover","hover","selectInfo","getOpenTransitionName","direction","len","concat","reverse","activeIndex","ci","slice","undefined","start","child","renderCommonMenuItem","extraProps","childProps","isActive","newChildProps","rootPrefixCls","ref","bind","subMenuOpenDelay","subMenuCloseDelay","forceSubMenuRender","builtinPlacements","cloneElement","subMenuKey","connected"],"mappings":"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","sourcesContent":["import _objectWithoutProperties from 'babel-runtime/helpers/objectWithoutProperties';\nimport _classCallCheck from 'babel-runtime/helpers/classCallCheck';\nimport _possibleConstructorReturn from 'babel-runtime/helpers/possibleConstructorReturn';\nimport _inherits from 'babel-runtime/helpers/inherits';\nimport _extends from 'babel-runtime/helpers/extends';\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { connect } from 'mini-store';\nimport KeyCode from 'rc-util/es/KeyCode';\nimport createChainedFunction from 'rc-util/es/createChainedFunction';\nimport classNames from 'classnames';\nimport { getKeyFromChildrenIndex, loopMenuItem, noop, menuAllProps, isMobileDevice } from './util';\nimport DOMWrap from './DOMWrap';\n\nfunction allDisabled(arr) {\n  if (!arr.length) {\n    return true;\n  }\n  return arr.every(function (c) {\n    return !!c.props.disabled;\n  });\n}\n\nfunction updateActiveKey(store, menuId, activeKey) {\n  var _extends2;\n\n  var state = store.getState();\n  store.setState({\n    activeKey: _extends({}, state.activeKey, (_extends2 = {}, _extends2[menuId] = activeKey, _extends2))\n  });\n}\n\nfunction getEventKey(props) {\n  // when eventKey not available ,it's menu and return menu id '0-menu-'\n  return props.eventKey || '0-menu-';\n}\n\nexport function getActiveKey(props, originalActiveKey) {\n  var activeKey = originalActiveKey;\n  var children = props.children,\n      eventKey = props.eventKey;\n\n  if (activeKey) {\n    var found = void 0;\n    loopMenuItem(children, function (c, i) {\n      if (c && !c.props.disabled && activeKey === getKeyFromChildrenIndex(c, eventKey, i)) {\n        found = true;\n      }\n    });\n    if (found) {\n      return activeKey;\n    }\n  }\n  activeKey = null;\n  if (props.defaultActiveFirst) {\n    loopMenuItem(children, function (c, i) {\n      if (!activeKey && c && !c.props.disabled) {\n        activeKey = getKeyFromChildrenIndex(c, eventKey, i);\n      }\n    });\n    return activeKey;\n  }\n  return activeKey;\n}\n\nexport function saveRef(c) {\n  if (c) {\n    var index = this.instanceArray.indexOf(c);\n    if (index !== -1) {\n      // update component if it's already inside instanceArray\n      this.instanceArray[index] = c;\n    } else {\n      // add component if it's not in instanceArray yet;\n      this.instanceArray.push(c);\n    }\n  }\n}\n\nexport var SubPopupMenu = function (_React$Component) {\n  _inherits(SubPopupMenu, _React$Component);\n\n  function SubPopupMenu(props) {\n    var _extends3;\n\n    _classCallCheck(this, SubPopupMenu);\n\n    var _this = _possibleConstructorReturn(this, _React$Component.call(this, props));\n\n    _initialiseProps.call(_this);\n\n    props.store.setState({\n      activeKey: _extends({}, props.store.getState().activeKey, (_extends3 = {}, _extends3[props.eventKey] = getActiveKey(props, props.activeKey), _extends3))\n    });\n\n    _this.instanceArray = [];\n    return _this;\n  }\n\n  SubPopupMenu.prototype.componentDidMount = function componentDidMount() {\n    // invoke customized ref to expose component to mixin\n    if (this.props.manualRef) {\n      this.props.manualRef(this);\n    }\n  };\n\n  SubPopupMenu.prototype.shouldComponentUpdate = function shouldComponentUpdate(nextProps) {\n    return this.props.visible || nextProps.visible;\n  };\n\n  SubPopupMenu.prototype.componentDidUpdate = function componentDidUpdate(prevProps) {\n    var props = this.props;\n    var originalActiveKey = 'activeKey' in props ? props.activeKey : props.store.getState().activeKey[getEventKey(props)];\n    var activeKey = getActiveKey(props, originalActiveKey);\n    if (activeKey !== originalActiveKey) {\n      updateActiveKey(props.store, getEventKey(props), activeKey);\n    } else if ('activeKey' in prevProps) {\n      // If prev activeKey is not same as current activeKey,\n      // we should set it.\n      var prevActiveKey = getActiveKey(prevProps, prevProps.activeKey);\n      if (activeKey !== prevActiveKey) {\n        updateActiveKey(props.store, getEventKey(props), activeKey);\n      }\n    }\n  };\n\n  // all keyboard events callbacks run from here at first\n\n\n  SubPopupMenu.prototype.render = function render() {\n    var _this2 = this;\n\n    var props = _objectWithoutProperties(this.props, []);\n\n    this.instanceArray = [];\n    var className = classNames(props.prefixCls, props.className, props.prefixCls + '-' + props.mode);\n    var domProps = {\n      className: className,\n      // role could be 'select' and by default set to menu\n      role: props.role || 'menu'\n    };\n    if (props.id) {\n      domProps.id = props.id;\n    }\n    if (props.focusable) {\n      domProps.tabIndex = '0';\n      domProps.onKeyDown = this.onKeyDown;\n    }\n    var prefixCls = props.prefixCls,\n        eventKey = props.eventKey,\n        visible = props.visible,\n        level = props.level,\n        mode = props.mode,\n        overflowedIndicator = props.overflowedIndicator,\n        theme = props.theme;\n\n    menuAllProps.forEach(function (key) {\n      return delete props[key];\n    });\n\n    // Otherwise, the propagated click event will trigger another onClick\n    delete props.onClick;\n\n    return (\n      // ESLint is not smart enough to know that the type of `children` was checked.\n      /* eslint-disable */\n      React.createElement(\n        DOMWrap,\n        _extends({}, props, {\n          prefixCls: prefixCls,\n          mode: mode,\n          tag: 'ul',\n          level: level,\n          theme: theme,\n          hiddenClassName: prefixCls + '-hidden',\n          visible: visible,\n          overflowedIndicator: overflowedIndicator\n        }, domProps),\n        React.Children.map(props.children, function (c, i) {\n          return _this2.renderMenuItem(c, i, eventKey || '0-menu-');\n        })\n      )\n      /*eslint-enable */\n\n    );\n  };\n\n  return SubPopupMenu;\n}(React.Component);\nSubPopupMenu.propTypes = {\n  onSelect: PropTypes.func,\n  onClick: PropTypes.func,\n  onDeselect: PropTypes.func,\n  onOpenChange: PropTypes.func,\n  onDestroy: PropTypes.func,\n  openTransitionName: PropTypes.string,\n  openAnimation: PropTypes.oneOfType([PropTypes.string, PropTypes.object]),\n  openKeys: PropTypes.arrayOf(PropTypes.string),\n  visible: PropTypes.bool,\n  children: PropTypes.any,\n  parentMenu: PropTypes.object,\n  eventKey: PropTypes.string,\n  store: PropTypes.shape({\n    getState: PropTypes.func,\n    setState: PropTypes.func\n  }),\n\n  // adding in refactor\n  focusable: PropTypes.bool,\n  multiple: PropTypes.bool,\n  style: PropTypes.object,\n  defaultActiveFirst: PropTypes.bool,\n  activeKey: PropTypes.string,\n  selectedKeys: PropTypes.arrayOf(PropTypes.string),\n  defaultSelectedKeys: PropTypes.arrayOf(PropTypes.string),\n  defaultOpenKeys: PropTypes.arrayOf(PropTypes.string),\n  level: PropTypes.number,\n  mode: PropTypes.oneOf(['horizontal', 'vertical', 'vertical-left', 'vertical-right', 'inline']),\n  triggerSubMenuAction: PropTypes.oneOf(['click', 'hover']),\n  inlineIndent: PropTypes.oneOfType([PropTypes.number, PropTypes.string]),\n  manualRef: PropTypes.func,\n  itemIcon: PropTypes.oneOfType([PropTypes.func, PropTypes.node]),\n  expandIcon: PropTypes.oneOfType([PropTypes.func, PropTypes.node])\n};\nSubPopupMenu.defaultProps = {\n  prefixCls: 'rc-menu',\n  className: '',\n  mode: 'vertical',\n  level: 1,\n  inlineIndent: 24,\n  visible: true,\n  focusable: true,\n  style: {},\n  manualRef: noop\n};\n\nvar _initialiseProps = function _initialiseProps() {\n  var _this3 = this;\n\n  this.onKeyDown = function (e, callback) {\n    var keyCode = e.keyCode;\n    var handled = void 0;\n    _this3.getFlatInstanceArray().forEach(function (obj) {\n      if (obj && obj.props.active && obj.onKeyDown) {\n        handled = obj.onKeyDown(e);\n      }\n    });\n    if (handled) {\n      return 1;\n    }\n    var activeItem = null;\n    if (keyCode === KeyCode.UP || keyCode === KeyCode.DOWN) {\n      activeItem = _this3.step(keyCode === KeyCode.UP ? -1 : 1);\n    }\n    if (activeItem) {\n      e.preventDefault();\n      updateActiveKey(_this3.props.store, getEventKey(_this3.props), activeItem.props.eventKey);\n\n      if (typeof callback === 'function') {\n        callback(activeItem);\n      }\n\n      return 1;\n    }\n  };\n\n  this.onItemHover = function (e) {\n    var key = e.key,\n        hover = e.hover;\n\n    updateActiveKey(_this3.props.store, getEventKey(_this3.props), hover ? key : null);\n  };\n\n  this.onDeselect = function (selectInfo) {\n    _this3.props.onDeselect(selectInfo);\n  };\n\n  this.onSelect = function (selectInfo) {\n    _this3.props.onSelect(selectInfo);\n  };\n\n  this.onClick = function (e) {\n    _this3.props.onClick(e);\n  };\n\n  this.onOpenChange = function (e) {\n    _this3.props.onOpenChange(e);\n  };\n\n  this.onDestroy = function (key) {\n    /* istanbul ignore next */\n    _this3.props.onDestroy(key);\n  };\n\n  this.getFlatInstanceArray = function () {\n    return _this3.instanceArray;\n  };\n\n  this.getOpenTransitionName = function () {\n    return _this3.props.openTransitionName;\n  };\n\n  this.step = function (direction) {\n    var children = _this3.getFlatInstanceArray();\n    var activeKey = _this3.props.store.getState().activeKey[getEventKey(_this3.props)];\n    var len = children.length;\n    if (!len) {\n      return null;\n    }\n    if (direction < 0) {\n      children = children.concat().reverse();\n    }\n    // find current activeIndex\n    var activeIndex = -1;\n    children.every(function (c, ci) {\n      if (c && c.props.eventKey === activeKey) {\n        activeIndex = ci;\n        return false;\n      }\n      return true;\n    });\n    if (!_this3.props.defaultActiveFirst && activeIndex !== -1 && allDisabled(children.slice(activeIndex, len - 1))) {\n      return undefined;\n    }\n    var start = (activeIndex + 1) % len;\n    var i = start;\n\n    do {\n      var child = children[i];\n      if (!child || child.props.disabled) {\n        i = (i + 1) % len;\n      } else {\n        return child;\n      }\n    } while (i !== start);\n\n    return null;\n  };\n\n  this.renderCommonMenuItem = function (child, i, extraProps) {\n    var state = _this3.props.store.getState();\n    var props = _this3.props;\n    var key = getKeyFromChildrenIndex(child, props.eventKey, i);\n    var childProps = child.props;\n    var isActive = key === state.activeKey;\n    var newChildProps = _extends({\n      mode: childProps.mode || props.mode,\n      level: props.level,\n      inlineIndent: props.inlineIndent,\n      renderMenuItem: _this3.renderMenuItem,\n      rootPrefixCls: props.prefixCls,\n      index: i,\n      parentMenu: props.parentMenu,\n      // customized ref function, need to be invoked manually in child's componentDidMount\n      manualRef: childProps.disabled ? undefined : createChainedFunction(child.ref, saveRef.bind(_this3)),\n      eventKey: key,\n      active: !childProps.disabled && isActive,\n      multiple: props.multiple,\n      onClick: function onClick(e) {\n        (childProps.onClick || noop)(e);\n        _this3.onClick(e);\n      },\n      onItemHover: _this3.onItemHover,\n      openTransitionName: _this3.getOpenTransitionName(),\n      openAnimation: props.openAnimation,\n      subMenuOpenDelay: props.subMenuOpenDelay,\n      subMenuCloseDelay: props.subMenuCloseDelay,\n      forceSubMenuRender: props.forceSubMenuRender,\n      onOpenChange: _this3.onOpenChange,\n      onDeselect: _this3.onDeselect,\n      onSelect: _this3.onSelect,\n      builtinPlacements: props.builtinPlacements,\n      itemIcon: childProps.itemIcon || _this3.props.itemIcon,\n      expandIcon: childProps.expandIcon || _this3.props.expandIcon\n    }, extraProps);\n    // ref: https://github.com/ant-design/ant-design/issues/13943\n    if (props.mode === 'inline' || isMobileDevice()) {\n      newChildProps.triggerSubMenuAction = 'click';\n    }\n    return React.cloneElement(child, newChildProps);\n  };\n\n  this.renderMenuItem = function (c, i, subMenuKey) {\n    /* istanbul ignore if */\n    if (!c) {\n      return null;\n    }\n    var state = _this3.props.store.getState();\n    var extraProps = {\n      openKeys: state.openKeys,\n      selectedKeys: state.selectedKeys,\n      triggerSubMenuAction: _this3.props.triggerSubMenuAction,\n      subMenuKey: subMenuKey\n    };\n    return _this3.renderCommonMenuItem(c, i, extraProps);\n  };\n};\n\nvar connected = connect()(SubPopupMenu);\n\nexport default connected;"]}]}