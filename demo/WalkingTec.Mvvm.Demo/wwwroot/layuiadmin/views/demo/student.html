<title>学生管理</title><div class="layui-card layadmin-header"><div class="layui-breadcrumb" lay-filter="breadcrumb"><a lay-href="">主页</a> <a><cite>Sample</cite></a> <a><cite>Student</cite></a></div></div><style>.flexContainer{display:flex;display:-webkit-flex;flex-direction:column;height:706px}.flexTest{height:558px;flex:1;overflow:hidden}.flexTable{overflow-y:auto;overflow-x:hidden;height:558px;flex:1}</style><div id="flexContainer" class="flexContainer"><div id="search1"><form id="wtForm_89379ad56ff84eeba90ccedaf6e81ff5" class="layui-form" method="post" lay-filter="wtForm_89379ad56ff84eeba90ccedaf6e81ff5form" action="/Student/Index?v=1.2.1"><div class="layui-collapse" style="margin-bottom:5px" lay-filter="417c44deaaf043949ebe46cee31b87da"><div class="layui-colla-item"><h2 class="layui-colla-title">搜索条件<div style="text-align:right;margin-top:-43px" id="417c44deaaf043949ebe46cee31b87da"><a href="javascript:void(0)" class="layui-btn layui-btn-sm" id="wtSearchBtn_89379ad56ff84eeba90ccedaf6e81ff5"><i class="layui-icon">&#xe615;</i>搜索</a> <button type="reset" class="layui-btn layui-btn-sm" id="wtResetBtn_89379ad56ff84eeba90ccedaf6e81ff5">重置</button></div></h2><div class="layui-colla-content layui-show"><div class="layui-row"><div class="layui-col-md4"><div class="layui-form-item"><label for="StudentListVM_Searcher_LoginName" class="layui-form-label">账号:</label><div class="layui-input-block"><input type="text" name="Searcher.LoginName" placeholder="" class="layui-input" id="StudentListVM_Searcher_LoginName" lay-filter="StudentListVM_Searcher_LoginNamefilter"></div></div></div><div class="layui-col-md4"><div class="layui-form-item"><label for="StudentListVM_Searcher_Name" class="layui-form-label">姓名:</label><div class="layui-input-block"><input type="text" name="Searcher.Name" placeholder="" class="layui-input" id="StudentListVM_Searcher_Name" lay-filter="StudentListVM_Searcher_Namefilter"></div></div></div><div class="layui-col-md4"><div class="layui-form-item"><label for="StudentListVM_Searcher_IsValid" class="layui-form-label">有效:</label><div class="layui-input-block"><select name="Searcher.IsValid" lay-filter="Searcher.IsValid" wtm-name="Searcher.IsValid" id="StudentListVM_Searcher_IsValid"><option value="">全部</option><option value="true">是</option><option value="false">否</option></select></div></div></div></div></div></div></div></form></div><div id="student1"><div style="text-align:right;padding-bottom:10px;padding-top:5px;margin-right:15px"><a href="javascript:void(0)" onclick='wtToolBarFunc_wtTable_89379ad56ff84eeba90ccedaf6e81ff5({event:"StudentCreate"})' class="layui-btn layui-btn-sm"><i class="layui-icon layui-icon-add-1"></i>新建</a> <a href="javascript:void(0)" onclick='wtToolBarFunc_wtTable_89379ad56ff84eeba90ccedaf6e81ff5({event:"StudentBatchEdit"})' class="layui-btn layui-btn-sm"><i class="layui-icon layui-icon-edit"></i>批量修改</a> <a href="javascript:void(0)" onclick='wtToolBarFunc_wtTable_89379ad56ff84eeba90ccedaf6e81ff5({event:"StudentBatchDelete"})' class="layui-btn layui-btn-sm"><i class="layui-icon layui-icon-delete"></i>批量删除</a> <a href="javascript:void(0)" onclick='wtToolBarFunc_wtTable_89379ad56ff84eeba90ccedaf6e81ff5({event:"StudentImport"})' class="layui-btn layui-btn-sm"><i class="layui-icon layui-icon-templeate-1"></i>导入</a> <a href="javascript:void(0)" onclick='wtToolBarFunc_wtTable_89379ad56ff84eeba90ccedaf6e81ff5({event:"_FrameworkGetExportExcel"})' class="layui-btn layui-btn-sm"><i class="layui-icon layui-icon-download-circle"></i>导出Excel</a></div><table id="wtTable_89379ad56ff84eeba90ccedaf6e81ff5" lay-filter="wtTable_89379ad56ff84eeba90ccedaf6e81ff5"></table></div></div><script>layui.use(['table'], function () {
    const table = layui.table;

    layui.element.init();
    $('#417c44deaaf043949ebe46cee31b87da .layui-btn').on('click', function (e) { e.stopPropagation(); })
    $('#wtResetBtn_89379ad56ff84eeba90ccedaf6e81ff5').on('click', function (btn) {
      var hiddenAreas = $('#' + this.form.id + ' input[wtm-tag=wtmselector]')
      if (hiddenAreas && hiddenAreas.length > 0) {
        for (i = 0; i < hiddenAreas.length; i++) {
          hiddenAreas[i].remove();
        }
      }
    });

    $('#wtSearchBtn_89379ad56ff84eeba90ccedaf6e81ff5').on('click', function () {
      table.reload('wtTable_89379ad56ff84eeba90ccedaf6e81ff5', {
        where: $.extend(wtVar_89379ad56ff84eeba90ccedaf6e81ff5.config.where, ff.GetSearchFormData('wtForm_89379ad56ff84eeba90ccedaf6e81ff5', '')),
        done: function (res, curr, count) {
          if (this.height == undefined) {
            // var tab = $('#wtTable_89379ad56ff84eeba90ccedaf6e81ff5 + .layui-table-view');
            // tab.find('.layui-table-main').addClass('flexTable');
            // tab.children('.layui-table-box').addClass('flexTest');
          }
          // if (this.height == undefined) {
          //   var tab = $('#wtTable_89379ad56ff84eeba90ccedaf6e81ff5 + .layui-table-view');
          //   tab.css('overflow', 'hidden').addClass('donotuse_fill donotuse_pdiv');
          //   tab.children('.layui-table-box').addClass('donotuse_fill donotuse_pdiv').css('height', '100px');
          //   tab.find('.layui-table-main').addClass('donotuse_fill');
          //   tab.find('.layui-table-header').css('min-height', '40px');
          //   ff.triggerResize();
          // }
        }
      })
      /* 暂时解决 layui table首次及table.reload()无loading的bug */
    });

    layui.element.on('collapse(417c44deaaf043949ebe46cee31b87da)', function (data) { ff.triggerResize() });

  })
  layui.use(['form'], function () {
    var form = layui.form.render(null, 'wtForm_89379ad56ff84eeba90ccedaf6e81ff5form');
    var comboxs = $(".layui-form[lay-filter='wtForm_89379ad56ff84eeba90ccedaf6e81ff5form'] select[wtm-combo='MULTI_COMBO']");
    /* 启用 ComboBox 多选 */
    for (var i = 0; i < comboxs.length; i++) {
      var filter = comboxs[i].attributes['lay-filter'].value, arr = [], subTag = $('input[name="' + filter + '"]');
      for (var i = 0; i < subTag.length; i++) {
        arr.push({ name: subTag[i].attributes['text'].value, val: subTag[i].value });
      }
      formSelects.on({
        layFilter: filter, left: '', right: '', separator: ',', arr: arr,
        selectFunc: null
      })
    }
  })
  layui.use(['table'], function () {
    var table = layui.table;
    var layer = layui.layer;
    var wtTable_89379ad56ff84eeba90ccedaf6e81ff5option = {
      elem: '#wtTable_89379ad56ff84eeba90ccedaf6e81ff5'
      , id: 'wtTable_89379ad56ff84eeba90ccedaf6e81ff5'
      , autoSort: false
      , totalRow: false
      , url: '/_Framework/GetPagingData'
      , where: { "_DONOT_USE_VMNAME": "WalkingTec.Mvvm.Demo.ViewModels.StudentVMs.StudentListVM, WalkingTec.Mvvm.Demo", "_DONOT_USE_CS": "default", "SearcherMode": 0, "Searcher.LoginName": null, "Searcher.Name": null, "Searcher.Session": { "SessionId": "15c94166-617d-f8b8-25c5-6d0b9eb85869" }, "Searcher.ParentId": null, "Searcher.IsValid": null }
      , method: 'post'
      , loading: true
      , request: { "pageName": "Searcher.Page", "limitName": "Searcher.Limit" }
      , response: { "statusName": "Code", "statusCode": 200, "msgName": "Msg", "countName": "Count", "dataName": "Data" }
      , page: true
      , limit: 20
      , limits: [10, 20, 50, 80, 100, 150, 200]
      // , height: 'full-278'

      , cols: [[{ "type": "checkbox", "width": 45, "rowspan": 1, "fixed": "left", "align": "center", "totalRowText": "合计：" }, { "type": "numbers", "width": 45, "rowspan": 1, "fixed": "left", "align": "center" }, {
        "field": "LoginName", "title": "账号", "align": "left", "templet": function (d) {
          var sty = ''; var bg = ''; var did = 'LoginName_' + d.LAY_INDEX; if (d.LoginName__bgcolor != undefined) bg = "<script>$('#" + did + "').closest('td').css('background-color','" + d.LoginName__bgcolor + "');</s" + "cript>"; if (d.LoginName__forecolor != undefined) sty = 'color:' + d.LoginName__forecolor + ';'; return '<div style="' + sty + '" id="' + did + '">' + d.LoginName.replace(/\"/g, "'") + bg + '</div>';
        }
      }, {
        "field": "Password", "title": "密码", "align": "left", "templet": function (d) {
          var sty = ''; var bg = ''; var did = 'Password_' + d.LAY_INDEX; if (d.Password__bgcolor != undefined) bg = "<script>$('#" + did + "').closest('td').css('background-color','" + d.Password__bgcolor + "');</s" + "cript>"; if (d.Password__forecolor != undefined) sty = 'color:' + d.Password__forecolor + ';'; return '<div style="' + sty + '" id="' + did + '">' + d.Password.replace(/\"/g, "'") + bg + '</div>';
        }
      }, {
        "field": "Email", "title": "邮箱", "align": "left", "templet": function (d) {
          var sty = ''; var bg = ''; var did = 'Email_' + d.LAY_INDEX; if (d.Email__bgcolor != undefined) bg = "<script>$('#" + did + "').closest('td').css('background-color','" + d.Email__bgcolor + "');</s" + "cript>"; if (d.Email__forecolor != undefined) sty = 'color:' + d.Email__forecolor + ';'; return '<div style="' + sty + '" id="' + did + '">' + d.Email.replace(/\"/g, "'") + bg + '</div>';
        }
      }, {
        "field": "Name", "title": "姓名", "align": "left", "templet": function (d) {
          var sty = ''; var bg = ''; var did = 'Name_' + d.LAY_INDEX; if (d.Name__bgcolor != undefined) bg = "<script>$('#" + did + "').closest('td').css('background-color','" + d.Name__bgcolor + "');</s" + "cript>"; if (d.Name__forecolor != undefined) sty = 'color:' + d.Name__forecolor + ';'; return '<div style="' + sty + '" id="' + did + '">' + d.Name.replace(/\"/g, "'") + bg + '</div>';
        }
      }, {
        "field": "Sex", "title": "性别", "align": "center", "templet": function (d) {
          var sty = ''; var bg = ''; var did = 'Sex_' + d.LAY_INDEX; if (d.Sex__bgcolor != undefined) bg = "<script>$('#" + did + "').closest('td').css('background-color','" + d.Sex__bgcolor + "');</s" + "cript>"; if (d.Sex__forecolor != undefined) sty = 'color:' + d.Sex__forecolor + ';'; return '<div style="' + sty + '" id="' + did + '">' + d.Sex.replace(/\"/g, "'") + bg + '</div>';
        }
      }, {
        "field": "CellPhone", "title": "手机", "align": "left", "templet": function (d) {
          var sty = ''; var bg = ''; var did = 'CellPhone_' + d.LAY_INDEX; if (d.CellPhone__bgcolor != undefined) bg = "<script>$('#" + did + "').closest('td').css('background-color','" + d.CellPhone__bgcolor + "');</s" + "cript>"; if (d.CellPhone__forecolor != undefined) sty = 'color:' + d.CellPhone__forecolor + ';'; return '<div style="' + sty + '" id="' + did + '">' + d.CellPhone.replace(/\"/g, "'") + bg + '</div>';
        }
      }, {
        "field": "Address", "title": "住址", "align": "left", "templet": function (d) {
          var sty = ''; var bg = ''; var did = 'Address_' + d.LAY_INDEX; if (d.Address__bgcolor != undefined) bg = "<script>$('#" + did + "').closest('td').css('background-color','" + d.Address__bgcolor + "');</s" + "cript>"; if (d.Address__forecolor != undefined) sty = 'color:' + d.Address__forecolor + ';'; return '<div style="' + sty + '" id="' + did + '">' + d.Address.replace(/\"/g, "'") + bg + '</div>';
        }
      }, {
        "field": "ZipCode", "title": "邮编", "align": "left", "templet": function (d) {
          var sty = ''; var bg = ''; var did = 'ZipCode_' + d.LAY_INDEX; if (d.ZipCode__bgcolor != undefined) bg = "<script>$('#" + did + "').closest('td').css('background-color','" + d.ZipCode__bgcolor + "');</s" + "cript>"; if (d.ZipCode__forecolor != undefined) sty = 'color:' + d.ZipCode__forecolor + ';'; return '<div style="' + sty + '" id="' + did + '">' + d.ZipCode.replace(/\"/g, "'") + bg + '</div>';
        }
      }, {
        "field": "PhotoId", "title": "照片", "align": "center", "templet": function (d) {
          var sty = ''; var bg = ''; var did = 'PhotoId_' + d.LAY_INDEX; if (d.PhotoId__bgcolor != undefined) bg = "<script>$('#" + did + "').closest('td').css('background-color','" + d.PhotoId__bgcolor + "');</s" + "cript>"; if (d.PhotoId__forecolor != undefined) sty = 'color:' + d.PhotoId__forecolor + ';'; return '<div style="' + sty + '" id="' + did + '">' + d.PhotoId.replace(/\"/g, "'") + bg + '</div>';
        }
      }, {
        "field": "IsValid", "title": "是否有效", "align": "center", "templet": function (d) {
          var sty = ''; var bg = ''; var did = 'IsValid_' + d.LAY_INDEX; if (d.IsValid__bgcolor != undefined) bg = "<script>$('#" + did + "').closest('td').css('background-color','" + d.IsValid__bgcolor + "');</s" + "cript>"; if (d.IsValid__forecolor != undefined) sty = 'color:' + d.IsValid__forecolor + ';'; return '<div style="' + sty + '" id="' + did + '">' + d.IsValid.replace(/\"/g, "'") + bg + '</div>';
        }
      }, {
        "field": "EnRollDate", "title": "日期", "align": "center", "templet": function (d) {
          var sty = ''; var bg = ''; var did = 'EnRollDate_' + d.LAY_INDEX; if (d.EnRollDate__bgcolor != undefined) bg = "<script>$('#" + did + "').closest('td').css('background-color','" + d.EnRollDate__bgcolor + "');</s" + "cript>"; if (d.EnRollDate__forecolor != undefined) sty = 'color:' + d.EnRollDate__forecolor + ';'; return '<div style="' + sty + '" id="' + did + '">' + d.EnRollDate.replace(/\"/g, "'") + bg + '</div>';
        }
      }, { "toolbar": "#wtToolBar_89379ad56ff84eeba90ccedaf6e81ff5", "title": "操作", "width": 200, "fixed": "right", "align": "center" }]]
      , even: true
      , done: function (res, curr, count) {
        // var tab = $('#wtTable_89379ad56ff84eeba90ccedaf6e81ff5 + .layui-table-view');
        // tab.find('.layui-table-main').addClass('flexTable');
        // tab.children('.layui-table-box').addClass('flexTest');

        // tab.find('table').css('border-collapse', 'separate');
        // tab.css('overflow', 'hidden').addClass('donotuse_fill donotuse_pdiv');
        // tab.children('.layui-table-box').addClass('donotuse_fill donotuse_pdiv').css('height', '100px');
        // tab.find('.layui-table-main').addClass('donotuse_fill');
        // tab.find('.layui-table-header').css('min-height', '40px');
        // ff.triggerResize();
      }
    }
    wtVar_89379ad56ff84eeba90ccedaf6e81ff5 = table.render(wtTable_89379ad56ff84eeba90ccedaf6e81ff5option);
    // 监听工具条
    function wtToolBarFunc_wtTable_89379ad56ff84eeba90ccedaf6e81ff5(obj) { //注：tool是工具条事件名，test是table原始容器的属性 lay-filter="对应的值"
      var data = obj.data, layEvent = obj.event, tr = obj.tr; //获得当前行 tr 的DOM对象
      switch (layEvent) {

        case 'StudentCreate': {
          var isPost = false;
          var tempUrl = '/Student/Create?1=1', whereStr = [];
          ff.OpenDialog(tempUrl, '5810ccc86fb34314b3b78755174ee87d', '新建', 800, null, isPost === true && ids !== null && ids !== undefined ? { 'Ids': ids } : undefined);
        }; break;
        case 'StudentEdit': {
          var isPost = false;
          var tempUrl = '/Student/Edit?1=1', whereStr = [];
          if (data == undefined || data == null || data.ID == undefined || data.ID == null) {
            var ids = ff.GetSelections('wtTable_89379ad56ff84eeba90ccedaf6e81ff5');
            if (ids.length == 0) {
              layui.layer.msg('请选择一行');
              return;
            } else if (ids.length > 1) {
              layui.layer.msg('最多只能选择一行');
              return;
            } else {
              tempUrl = tempUrl + '&id=' + ids[0];
              var objs = ff.GetSelectionData('wtTable_89379ad56ff84eeba90ccedaf6e81ff5');
              if (objs != null && objs.length > 0) {
                tempUrl = ff.concatWhereStr(tempUrl, whereStr, objs[0]);
              }
            }
          } else {
            tempUrl = tempUrl + '&id=' + data.ID;
            tempUrl = ff.concatWhereStr(tempUrl, whereStr, data);
          }

          ff.OpenDialog(tempUrl, 'a5022a6fb80c462cb3e64efb4f2af78a', '修改', 800, null, isPost === true && ids !== null && ids !== undefined ? { 'Ids': ids } : undefined);
        }; break;

        case 'StudentDelete': {
          var isPost = false;
          var tempUrl = '/Student/Delete?1=1', whereStr = [];
          if (data == undefined || data == null || data.ID == undefined || data.ID == null) {
            var ids = ff.GetSelections('wtTable_89379ad56ff84eeba90ccedaf6e81ff5');
            if (ids.length == 0) {
              layui.layer.msg('请选择一行');
              return;
            } else if (ids.length > 1) {
              layui.layer.msg('最多只能选择一行');
              return;
            } else {
              tempUrl = tempUrl + '&id=' + ids[0];
              var objs = ff.GetSelectionData('wtTable_89379ad56ff84eeba90ccedaf6e81ff5');
              if (objs != null && objs.length > 0) {
                tempUrl = ff.concatWhereStr(tempUrl, whereStr, objs[0]);
              }
            }
          } else {
            tempUrl = tempUrl + '&id=' + data.ID;
            tempUrl = ff.concatWhereStr(tempUrl, whereStr, data);
          }

          ff.OpenDialog(tempUrl, '1f060bc832884b7fb55316be9200fd1f', '删除', 800, null, isPost === true && ids !== null && ids !== undefined ? { 'Ids': ids } : undefined);
        }; break;

        case 'StudentDetails': {
          var isPost = false;
          var tempUrl = '/Student/Details?1=1', whereStr = [];
          if (data == undefined || data == null || data.ID == undefined || data.ID == null) {
            var ids = ff.GetSelections('wtTable_89379ad56ff84eeba90ccedaf6e81ff5');
            if (ids.length == 0) {
              layui.layer.msg('请选择一行');
              return;
            } else if (ids.length > 1) {
              layui.layer.msg('最多只能选择一行');
              return;
            } else {
              tempUrl = tempUrl + '&id=' + ids[0];
              var objs = ff.GetSelectionData('wtTable_89379ad56ff84eeba90ccedaf6e81ff5');
              if (objs != null && objs.length > 0) {
                tempUrl = ff.concatWhereStr(tempUrl, whereStr, objs[0]);
              }
            }
          } else {
            tempUrl = tempUrl + '&id=' + data.ID;
            tempUrl = ff.concatWhereStr(tempUrl, whereStr, data);
          }

          ff.OpenDialog(tempUrl, '37de773e21884447847674431528ae88', '详细', 800, null, isPost === true && ids !== null && ids !== undefined ? { 'Ids': ids } : undefined);
        }; break;

        case 'StudentBatchEdit': {
          var isPost = false;
          var tempUrl = '/Student/BatchEdit?1=1', whereStr = [];
          isPost = true;
          var ids = ff.GetSelections('wtTable_89379ad56ff84eeba90ccedaf6e81ff5');
          if (ids.length == 0) {
            layui.layer.msg('请至少选择一行');
            return;
          }

          ff.OpenDialog(tempUrl, 'c1c7e1fa6190431e889e31b7ca38a4c4', '批量修改', 800, null, isPost === true && ids !== null && ids !== undefined ? { 'Ids': ids } : undefined);
        }; break;

        case 'StudentBatchDelete': {
          var isPost = false;
          var tempUrl = '/Student/BatchDelete?1=1', whereStr = [];
          isPost = true;
          var ids = ff.GetSelections('wtTable_89379ad56ff84eeba90ccedaf6e81ff5');
          if (ids.length == 0) {
            layui.layer.msg('请至少选择一行');
            return;
          }

          ff.OpenDialog(tempUrl, 'b84ad1b984f7401f923887a34a014bfb', '批量删除', 800, null, isPost === true && ids !== null && ids !== undefined ? { 'Ids': ids } : undefined);
        }; break;

        case 'StudentImport': {
          var isPost = false;
          var tempUrl = '/Student/Import?1=1', whereStr = [];
          ff.OpenDialog(tempUrl, 'dbc7abe0dc3b485196422d66fed136f0', '导入', 800, null, isPost === true && ids !== null && ids !== undefined ? { 'Ids': ids } : undefined);
        }; break;

        case '_FrameworkGetExportExcel': {
          var isPost = false;
          var tempUrl = '/_Framework/GetExportExcel?1=1&_DONOT_USE_VMNAME=WalkingTec.Mvvm.Demo.ViewModels.StudentVMs.StudentListVM, WalkingTec.Mvvm.Demo', whereStr = null;
          var ids = ff.GetSelections('wtTable_89379ad56ff84eeba90ccedaf6e81ff5');
          isPost = true;

          ff.DownloadExcelOrPdf(tempUrl, 'wtForm_89379ad56ff84eeba90ccedaf6e81ff5', { "_DONOT_USE_VMNAME": "WalkingTec.Mvvm.Demo.ViewModels.StudentVMs.StudentListVM, WalkingTec.Mvvm.Demo", "_DONOT_USE_CS": "default", "SearcherMode": 0, "Searcher.LoginName": null, "Searcher.Name": null, "Searcher.Session": { "SessionId": "15c94166-617d-f8b8-25c5-6d0b9eb85869" }, "Searcher.ParentId": null, "Searcher.IsValid": null }, ids);
        }; break;
        default: break;
      }
      return;
    }

    table.on('tool(wtTable_89379ad56ff84eeba90ccedaf6e81ff5)', wtToolBarFunc_wtTable_89379ad56ff84eeba90ccedaf6e81ff5);
    table.on('sort(wtTable_89379ad56ff84eeba90ccedaf6e81ff5)', function (obj) {
      var sortfilter = {};
      sortfilter['Searcher.SortInfo.Property'] = obj.field;
      sortfilter['Searcher.SortInfo.Direction'] = obj.type.replace(obj.type[0], obj.type[0].toUpperCase());
      var w = $.extend(wtTable_89379ad56ff84eeba90ccedaf6e81ff5option.where, sortfilter);

      table.reload('wtTable_89379ad56ff84eeba90ccedaf6e81ff5', {
        initSort: obj,
        where: w
      });
    });
  })</script><script type="text/html" id="wtToolBar_89379ad56ff84eeba90ccedaf6e81ff5"><a class="layui-btn layui-btn-primary layui-btn-xs" lay-event="StudentEdit">修改</a><a class="layui-btn layui-btn-primary layui-btn-xs" lay-event="StudentDelete">删除</a><a class="layui-btn layui-btn-primary layui-btn-xs" lay-event="StudentDetails">详细</a></script>